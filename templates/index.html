{% extends 'base.html' %}

{% block title %}Dashboard de Aulas{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1>Aulas Registradas</h1>
  <a href="{{ url_for('add_aula') }}" class="btn btn-primary">Registrar Nueva Aula</a>
</div>

<div class="search-container mb-4">
  <form method="GET" action="{{ url_for('index') }}">
    <div class="input-group">
      <input type="text" name="q" class="form-control" placeholder="Buscar por edificio, aula, materiales..." value="{{ request.args.get('q', '') }}">
      <button type="submit" class="btn btn-info">Buscar</button>
    </div>
  </form>
</div>

{% for aula in aulas %}
<div class="card mb-3">
  <div class="card-header">
    <h2 class="h5 mb-0">
      <a href="{{ url_for('aula_detalle', aula_id=aula.id) }}" class="text-decoration-none">
        {{ aula.edificio }} - {{ aula.nombre_aula }}
      </a>
    </h2>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-6">
        <h5 class="card-title">Detalles</h5>
        <ul class="list-group list-group-flush">
          <li class="list-group-item"><strong>Materiales:</strong> {{ aula.materiales or 'N/A' }}</li>
          <li class="list-group-item"><strong>Ventanas:</strong> {{ aula.num_ventanas }}</li>
          <li class="list-group-item"><strong>Cielo Raso:</strong> {% if aula.cielo_raso %}Sí{% else %}No{% endif %}</li>
          <li class="list-group-item"><strong>Paredes de Yeso:</strong> {% if aula.paredes_yeso %}Sí{% else %}No{% endif %}</li>
        </ul>
      </div>
      <div class="col-md-6">
        <h5 class="card-title">Imágenes</h5>
        <div class="d-flex flex-wrap">
          {% for img in aula.imagenes|batch(4)|first %} <img src="{{ url_for('get_aula_image', filename=img.filename) }}" alt="Foto de aula" class="img-thumbnail m-1" style="width: 100px; height: 100px; object-fit: cover;">
          {% else %}
            <p>No hay imágenes.</p>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
{% else %}
  <div class="alert alert-warning" role="alert">
    No hay aulas registradas todavía. ¡Añade una!
  </div>
{% endfor %}

{% endblock %}